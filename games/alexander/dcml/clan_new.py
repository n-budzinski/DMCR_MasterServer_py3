import sqlalchemy

def clan_new(options: dict, database: sqlalchemy.Engine, player_id) -> str:
    if options['title'] and options['signature']:
        try:
            with database.connect() as connection:
                connection.execute(sqlalchemy.text(f'INSERT INTO clans (creator, title, signature, info) VALUES ({player_id}, "{options["title"]}", "{options["signature"]}", "{options["info"]}")'))
                connection.commit()
        except:
            pass
        
        else:
            return " ".join((
                f"#ebox[%TB](x:0,y:0,w:100%,h:100%) ",
                f"#pix[%PXT1](%TB[x:0,y:38,w:100%,h:100%],{{}},Internet/pix/i_pri0,12,12,12,12)",
                f"#pix[%PXT2](%TB[x:0,y:263,w:100%,h:100%],{{}},Internet/pix/i_pri0,13,13,13,13)",
                f"#pan[%P1](%TB[x:42,y:0-22,w:0,h:80],10) ",
                f"#font(RG18,RG18,RG18)",
                f"#txt[%PL](%TB[x:737,y:0,w:150,h:20],{{}},\"Players\")",
                f"#font(BG18,BG18,BG18)",
                f"#ctxt[%TTTEXT](%TB[x:0-62,y:0-32,w:1024,h:20],{{}},\"PLAYER LIST\")",
                f"#font(R2C12,R2C12,R2C12)",
                f"#txt[%TMTEXT](%TB[x:0,y:514,w:100,h:20],{{}},\"Message:\")",
                f"#def_gp_btn(Internet/pix/i_pri0,53,53,0,1)",
                f"#font(RC12,R2C12,RC12)",
                f"#gpbtn[%BT1](%TB[x:74,y:23,w:-22,h:-18],{{GW|open&news.dcml\\00|LW_lockall}},\"News & Events\")",
                f"#hint(%BT1,\"News, events, forum and punishment list\")",
                f"#font(RC12,RC12,RC12)",
                f"#def_gp_btn(Internet/pix/i_pri0,51,51,0,1) ",
                f"#gpbtn[%BT2](%TB[x:196,y:22,w:-22,h:-18],{{GW|open&users_list.dcml\\00&language=\\00|LW_lockall}},\"Player List\")",
                f"#hint(%BT2,\"Player list, personal mail and clan information\")",
                f"#def_gp_btn(Internet/pix/i_pri0,52,52,0,1)",
                f"#font(RC12,R2C12,RC12)",
                f"#gpbtn[%BT4](%TB[x:318,y:23,w:-22,h:-18],{{GW|open&games.dcml\\00|LW_lockall}},\"Custom Games\")",
                f"#hint(%BT4,\"Play custom games\")#def_gp_btn(Internet/pix/i_pri0,52,52,0,1)",
                f"#font(RC12,R2C12,RC12)",
                f"#gpbtn[%BT5](%TB[x:440,y:23,w:-22,h:-18],{{GW|open&scored_games.dcml\\00&player_id=0\\00|LW_lockall}},\"Scored Games\")",
                f"#hint(%BT5,\"Played games and their scores\")",
                f"#ebox[%B_VOTE](x:5,y:396,w:140,h:103)",
                f"<VOTING>",
                f"#exec(GW|open&voting.dcml\\00&question=46\\00)",
                f"<VOTING>",
                f"#exec(GW|open&clans_list.dcml\\00&create_icon=true^signature=SAM\\00|LW_lockall)",
    ))
    return " ".join((
        f"#block(l_games_btn.cml,l_g):<!goback!>\\00 ",
        f"#end(l_g) ",
        f"#ebox[%TB](x:0,y:0,w:100%,h:100%) ",
        f"#pix[%PXT1](%TB[x:0,y:38,w:100%,h:100%],{{}},Internet/pix/i_pri0,12,12,12,12) ",
        f"#pix[%PXT2](%TB[x:0,y:263,w:100%,h:100%],{{}},Internet/pix/i_pri0,13,13,13,13) ",
        f"#pan[%P1](%TB[x:42,y:0-22,w:0,h:80],10) ",
        f"#font(RG18,RG18,RG18) ",
        f"#txt[%PL](%TB[x:737,y:0,w:150,h:20],{{}},\"Players\")",
        f"#font(BG18,BG18,BG18) ",
        f"#ctxt[%TTTEXT](%TB[x:0-62,y:0-32,w:1024,h:20],{{}},\"PLAYER LIST\")",
        f"#font(R2C12,R2C12,R2C12) ",
        f"#txt[%TMTEXT](%TB[x:0,y:514,w:100,h:20],{{}},\"Message:\") ",
        f"#def_gp_btn(Internet/pix/i_pri0,53,53,0,1)",
        f"#font(RC12,R2C12,RC12) ",
        f"#gpbtn[%BT1](%TB[x:74,y:23,w:-22,h:-18],{{GW|open&news.dcml\\00|LW_lockall}},\"News & Events\")",
        f"#hint(%BT1,\"News, events, forum and punishment list\")",
        f"#font(RC12,RC12,RC12) ",
        f"#def_gp_btn(Internet/pix/i_pri0,51,51,0,1) ",
        f"#gpbtn[%BT2](%TB[x:196,y:22,w:-22,h:-18],{{GW|open&users_list.dcml\\00&language=\\00|LW_lockall}},\"Player List\")",
        f"#hint(%BT2,\"Player list, personal mail and clan information\")",
        f"#def_gp_btn(Internet/pix/i_pri0,52,52,0,1)",
        f"#font(RC12,R2C12,RC12) ",
        f"#gpbtn[%BT4](%TB[x:318,y:23,w:-22,h:-18],{{GW|open&games.dcml\\00|LW_lockall}},\"Custom Games\")",
        f"#hint(%BT4,\"Play custom games\")",
        f"#def_gp_btn(Internet/pix/i_pri0,52,52,0,1)",
        f"#font(RC12,R2C12,RC12) ",
        f"#gpbtn[%BT5](%TB[x:440,y:23,w:-22,h:-18],{{GW|open&scored_games.dcml\\00&player_id=0\\00|LW_lockall}},\"Scored Games\")",
        f"#hint(%BT5,\"Played games and their scores\")",
        f"#ebox[%B_VOTE](x:5,y:396,w:140,h:103) ",
        f"<VOTING> ",
        f"#exec(GW|open&voting.dcml\\00&question=46\\00) ",
        f"<VOTING> ",
        f"#ebox[%B](x:0,y:0,w:100%,h:100%) ",
        f"#font(BC14,R2C14,RC14) ",
        f"#ctxt[%LIST1](%B[x:0,y:106,w:146,h:24],{{GW|open&users_list.dcml\\00|LW_lockall}},\"{{Player List}}\") ",
        f"#hint(%LIST1,\"Player list, personal mail and clan information\") ",
        f"#font(RC14,GC14,RC14) ",
        f"#ctxt[%LIST2](%B[x:0,y:%LIST1-9,w:146,h:24],{{GW|open&clans_list.dcml\\00|LW_lockall}},\"{{Clan List}}\") ",
        f"#hint(%LIST2,\"Clans, their members and details\") ",
        f"#exec(LW_cfile&\\00&Cookies/%GV_CLAN_TITLE) ",
        f"#exec(LW_cfile&\\00&Cookies/%GV_CLAN_SIGNA) ",
        f"#exec(LW_cfile&\\00&Cookies/%GV_CLAN_INFO) ",
        f"#ebox[%B0](x:154,y:42,w:559,h:291) ",
        f"#pan[%PAN](%B0[x:0,y:0,w:100%,h:100%],5) ",
        f"#font(RC12,R2C12,RC12) ",
        f"#txt[%TOP1](%B0[x:5,y:7,w:150,h:24],{{}},\"Create new clan\") ",
        f"#pix[%PX](%B0[x:5,y:27,w:100%,h:100%],{{}},Internet/pix/i_pri0,25,25,25,25) ",
        f"#font(R2C12,R2C12,RC12) ",
        f"#txt[%T1](%B0[x:5,y:43,w:150,h:24],{{}},\"Clan title:\") ",
        f"#font(BC12,BC12,RC12) ",
        f"#pan[%P2](%B0[x:9,y:62,w:542,h:14],1) ",
        f"#edit[%E1](%B0[x:13,y:61,w:535,h:18],{{%GV_CLAN_TITLE}},0,0,0,1) ",
        f"#font(R2C12,R2C12,RC12) ",
        f"#txt[%T2](%B0[x:5,y:88,w:120,h:24],{{}},\"Signature:\") ",
        f"#font(BC12,BC12,RC12) ",
        f"#pan[%P3](%B0[x:9,y:107,w:542,h:14],1) ",
        f"#edit[%E2](%B0[x:13,y:106,w:535,h:18],{{%GV_CLAN_SIGNA}}) ",
        f"#font(R2C12,R2C12,RC12) ",
        f"#txt[%T3](%B0[x:5,y:133,w:120,h:24],{{}},\"Clan info:\") ",
        f"#font(BC12,BC12,RC12) ",
        f"#pan[%P3](%B0[x:9,y:152,w:542,h:130],1) ",
        f"#edit[%E3](%B0[x:13,y:152,w:535,h:130],{{%GV_CLAN_INFO}},1) ",
        f"#font(BC14,WC14,BC14) ",
        f"#sbtn[%Create](%B[x:521,y:377,w:100,h:305],{{GW|open&clan_new.dcml\\00&cansel=true^title=<%GV_CLAN_TITLE>^signature=<%GV_CLAN_SIGNA>^info=<%GV_CLAN_INFO>\\00|LW_lockall}},\"Create\") ",
        f"#sbtn[%BT](%B[x:641,y:377,w:100,h:305],{{LW_file&Internet/Cash/l_games_btn.cml}},\"Cancel\") ",
        f"<NGDLG> ",
        f"<NGDLG> ",
        f"#block(cancel.cml,CAN)<NGDLG> ",
        f"<NGDLG> ",
        f"#end(CAN)"
    ))